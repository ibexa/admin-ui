services:
    _defaults:
        public: false
        autowire: true
        autoconfigure: true

    #
    # ContentTranslateView
    #
    Ibexa\AdminUi\View\Builder\ContentTranslateViewBuilder:
        arguments:
            $repository: '@ezpublish.api.repository'
            $viewConfigurator: '@ezpublish.view.configurator'
            $viewParametersInjector: '@ezpublish.view.view_parameters.injector.dispatcher'
            $contentActionDispatcher: '@ezplatform.content_forms.action_dispatcher.content'
        tags:
            - { name: ibexa.view_builder }

    Ibexa\AdminUi\View\Provider\ContentTranslateView\Configured:
        arguments:
            $matcherFactory: '@ezplatform.admin_ui.view.content_translate.matcher_factory'
        tags:
            - { name: ezpublish.view_provider, type: Ibexa\AdminUi\View\ContentTranslateView, priority: 10 }

    ezplatform.admin_ui.view.content_translate.matcher_factory:
        class: '%ezpublish.view.matcher_factory.class%'
        arguments:
            - '@Ibexa\Bundle\Core\Matcher\ViewMatcherRegistry'
            - '@ezpublish.api.repository'
            - 'Ibexa\Core\MVC\Symfony\Matcher\ContentBased'

    ezpublish.content_translate.matcher_factory.dynamically_configured:
        class: Ibexa\Core\MVC\Symfony\Matcher\DynamicallyConfiguredMatcherFactoryDecorator
        decorates: ezplatform.admin_ui.view.content_translate.matcher_factory
        arguments:
            $innerConfigurableMatcherFactory: '@ezpublish.content_view.matcher_factory.dynamically_configured.inner'
            $configResolver: '@ezpublish.config.resolver'
            $parameterName: content_translate_view

    Ibexa\AdminUi\View\Filter\ContentTranslateViewFilter:
        tags:
            - { name: kernel.event_subscriber }

    Ibexa\AdminUi\Limitation\Templating\LimitationBlockRenderer:
        arguments:
            $valueMapperRegistry: '@ezplatform.content_forms.limitation_value_mapper.registry'
            $twig: '@twig'
            $configResolver: '@ezpublish.config.resolver'

    Ibexa\AdminUi\View\Filter\AdminSearchViewFilter:
        decorates: Ibexa\Search\View\SearchViewFilter
        arguments:
            $configResolver: '@ezpublish.config.resolver'
            $formFactory: '@Symfony\Component\Form\FormFactoryInterface'
            $sectionService: '@ezpublish.api.service.section'
            $contentTypeService: '@ezpublish.api.service.content_type'
            $siteAccessGroups: '%ezpublish.siteaccess.groups%'
            $innerFilter: '@Ibexa\AdminUi\View\Filter\AdminSearchViewFilter.inner'
            $urlGenerator: '@router'
        tags:
            - { name: kernel.event_subscriber }
