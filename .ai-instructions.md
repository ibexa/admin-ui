# AI Assistant Instructions

This file provides instructions for AI coding assistants (Claude, Cursor, GitHub Copilot, Aider, etc.) working in this repository.

## üö® CRITICAL: Git Workflow Policy

### LOCAL CHANGES ONLY - NO REMOTE OPERATIONS

All changes made by AI assistants MUST remain local until the user explicitly decides to push them.

#### ‚ùå PROHIBITED ACTIONS (NEVER DO):

```bash
# NEVER run these commands:
git push
git push origin <branch>
git push --force
git push --set-upstream origin <branch>
gh pr create
gh pr create --title "..." --body "..."
hub pull-request
git merge origin/<branch>
git rebase origin/<branch>
```

**Why?** The user needs full control over what gets pushed to the remote repository and when PRs are created.

#### ‚úÖ ALLOWED ACTIONS (Local Only):

```bash
# These are OK:
git status
git diff
git diff HEAD
git log
git log --oneline
git add <files>
git commit -m "message"
git checkout -b <new-branch>
git branch
git show
```

**Why?** Local changes can be reviewed and modified before being shared.

#### üë§ USER MANUAL WORKFLOW:

1. **AI makes local changes** ‚Üí edits files, creates commits locally
2. **AI shows status** ‚Üí runs `git status` or `git diff` to show changes
3. **USER reviews** ‚Üí examines changes, runs tests, verifies everything
4. **USER pushes** ‚Üí runs `git push origin <branch>` when satisfied
5. **USER creates PR** ‚Üí uses GitHub UI or `gh pr create` manually
6. **USER requests review** ‚Üí assigns reviewers, manages PR lifecycle
7. **USER merges** ‚Üí merges PR after approval

### Example: Correct AI Workflow

```bash
# ‚úÖ CORRECT - AI Assistant does this:

# 1. Make changes to files (AI edits templates, JS, PHP, etc.)

# 2. Show what changed
git status
git diff

# 3. Create local branch if needed
git checkout -b feature/migrate-buttons-to-component

# 4. Stage and commit locally
git add src/bundle/Resources/views/themes/admin/content/draft/draft_list.html.twig
git commit -m "Migrate delete button in draft list to twig:ibexa:button component"

# 5. Show final status
git status

# 6. Tell user: "I've made local changes. Review with 'git diff' and push when ready."
```

```bash
# ‚ùå INCORRECT - AI Assistant should NEVER do this:

git add .
git commit -m "Migrate buttons"
git push origin feature/migrate-buttons  # ‚ùå WRONG - Don't push!
gh pr create --title "Migrate buttons"   # ‚ùå WRONG - Don't create PR!
```

---

## Package Information

**Package:** `ibexa/admin-ui`  
**Description:** Core Back Office interface bundle for Ibexa DXP (Digital Experience Platform)

### Key Files:
- `CLAUDE.md` - Package overview, commands, architecture
- `MIGRATION_RULES.md` - Button migration patterns and workflow
- `.cursorrules` - Cursor AI specific rules
- `.aider.conf.yml` - Aider configuration
- `.ai-rules` - General AI assistant rules

### Quick Commands:

```bash
# PHP
composer fix-cs          # Auto-fix PHP code style
composer check-cs        # Check code style
composer test            # Run all tests
composer phpstan         # Static analysis

# JavaScript/TypeScript
yarn test                # Run all checks
yarn fix                 # Auto-fix frontend issues

# Frontend Assets (run from project root, not package root)
yarn ibexa:dev           # Development build
yarn ibexa:build         # Production build
```

### Code Style Requirements:
- PHP: `declare(strict_types=1)` required in all files
- PHPStan level 8 with baseline
- Frontend: Prettier + ESLint via `@ibexa/eslint-config`

---

## Button Migration Project

When working on button migrations from legacy markup to `twig:ibexa:button` component:

1. **Read** `MIGRATION_RULES.md` for complete patterns
2. **Make** local changes following the patterns
3. **Commit** locally with descriptive messages
4. **Show** status and diffs to user
5. **Let user** push and create PRs manually

### Key Migration Rules:
- `ibexa-btn--ghost` ‚Üí `type="tertiary"`
- `ibexa-btn--primary` ‚Üí `type="primary"`
- `ibexa-btn--secondary` ‚Üí `type="secondary"`
- `ibexa-btn--small` ‚Üí `size="small"`
- `disabled` ‚Üí `:disabled="true"`
- `type="submit"` ‚Üí `html_type="submit"`

See `MIGRATION_RULES.md` for complete details.

---

## Summary

**DO:**
- ‚úÖ Make local file changes
- ‚úÖ Create local commits and branches
- ‚úÖ Run tests locally
- ‚úÖ Show `git status` and `git diff`
- ‚úÖ Follow code style requirements
- ‚úÖ Reference documentation files

**DON'T:**
- ‚ùå Push to remote (`git push`)
- ‚ùå Create pull requests (`gh pr create`)
- ‚ùå Force push (`git push --force`)
- ‚ùå Automatically merge or rebase with remote

**ALWAYS:**
- Let the user review changes before they go remote
- Let the user push and create PRs manually
- Show clear status of what was changed locally
